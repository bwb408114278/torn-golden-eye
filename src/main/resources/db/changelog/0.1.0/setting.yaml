databaseChangeLog:
  - changeSet:
      id: create_api_table
      author: Bai
      changes:
        - createTable:
            tableName: torn_api_key
            columns:
              - column:
                  name: id
                  type: BIGINT
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false
                  remarks: "ID"
              - column:
                  name: user_id
                  type: BIGINT
                  constraints:
                    nullable: false
                  remarks: "用户ID"
              - column:
                  name: api_key
                  type: VARCHAR(32)
                  constraints:
                    nullable: false
                  remarks: "Api Key"
              - column:
                  name: key_level
                  type: VARCHAR(8)
                  constraints:
                    nullable: false
                  remarks: "Key级别"
              - column:
                  name: use_count
                  type: INTEGER
                  constraints:
                    nullable: false
                  remarks: "使用次数"
              - column:
                  name: use_date
                  type: DATE
                  remarks: "使用日期"
                  constraints:
                    nullable: false
              - column:
                  name: deleted
                  type: TINYINT
                  defaultValueComputed: '0'
                  constraints:
                    nullable: false
                  remarks: "删除标识 1为已删除"
              - column:
                  name: create_time
                  type: TIMESTAMP
                  defaultValueComputed: CURRENT_TIMESTAMP
                  constraints:
                    nullable: false
                  remarks: "创建时间"
              - column:
                  name: update_time
                  type: TIMESTAMP
                  defaultValueComputed: CURRENT_TIMESTAMP
                  constraints:
                    nullable: false
                  remarks: "更新时间"

  - changeSet:
      id: create_setting_table
      author: Bai
      changes:
        - createTable:
            tableName: sys_setting
            columns:
              - column:
                  name: id
                  type: BIGINT
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false
                  remarks: "ID"
              - column:
                  name: setting_key
                  type: VARCHAR(32)
                  constraints:
                    nullable: false
                  remarks: "设置Key"
              - column:
                  name: setting_value
                  type: VARCHAR(64)
                  constraints:
                    nullable: false
                  remarks: "设置值"
              - column:
                  name: deleted
                  type: TINYINT
                  defaultValueComputed: '0'
                  constraints:
                    nullable: false
                  remarks: "删除标识 1为已删除"
              - column:
                  name: create_time
                  type: TIMESTAMP
                  defaultValueComputed: CURRENT_TIMESTAMP
                  constraints:
                    nullable: false
                  remarks: "创建时间"
              - column:
                  name: update_time
                  type: TIMESTAMP
                  defaultValueComputed: CURRENT_TIMESTAMP
                  constraints:
                    nullable: false
                  remarks: "更新时间"
        - addUniqueConstraint:
            tableName: sys_setting
            columnNames: setting_key
            constraintName: uk_setting_key
        - insert:
            tableName: sys_setting
            columns:
              - column:
                  name: setting_key
                  value: "ITEM_USED_LOAD_DATE"
              - column:
                  name: setting_value
                  value: "2025-08-08"

  - changeSet:
      id: bind_key_and_qq
      author: Bai
      changes:
        - addColumn:
            tableName: torn_api_key
            columns:
              - column:
                  name: qq_id
                  type: BIGINT
                  constraints:
                    nullable: false
                  defaultValue: "0"
                  remarks: "QQ号"

  - changeSet:
      id: add_oc_pass_rate_load_date
      author: Bai
      changes:
        - insert:
            tableName: sys_setting
            columns:
              - column:
                  name: setting_key
                  value: "OC_PASS_RATE_LOAD_DATE"
              - column:
                  name: setting_value
                  value: "2025-08-19"

  - changeSet:
      id: add_key_faction_access
      author: Bai
      changes:
        - addColumn:
            tableName: torn_api_key
            columns:
              - column:
                  name: has_faction_access
                  type: BOOL
                  constraints:
                    nullable: false
                  defaultValue: "f"
                  remarks: "是否有帮派权限"

  - changeSet:
      id: create_oc_setting_table
      author: Bai
      changes:
        - createTable:
            tableName: torn_setting_oc
            columns:
              - column:
                  name: id
                  type: BIGINT
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false
                  remarks: "ID"
              - column:
                  name: oc_name
                  type: VARCHAR(64)
                  constraints:
                    nullable: false
                  remarks: "OC名称"
              - column:
                  name: rank
                  type: TINYINT
                  constraints:
                    nullable: false
                  remarks: "OC级别"
              - column:
                  name: deleted
                  type: TINYINT
                  defaultValueComputed: '0'
                  constraints:
                    nullable: false
                  remarks: "删除标识 1为已删除"
              - column:
                  name: create_time
                  type: TIMESTAMP
                  defaultValueComputed: CURRENT_TIMESTAMP
                  constraints:
                    nullable: false
                  remarks: "创建时间"
              - column:
                  name: update_time
                  type: TIMESTAMP
                  defaultValueComputed: CURRENT_TIMESTAMP
                  constraints:
                    nullable: false
                  remarks: "更新时间"
        - createTable:
            tableName: torn_setting_oc_slot
            columns:
              - column:
                  name: id
                  type: BIGINT
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false
                  remarks: "ID"
              - column:
                  name: oc_name
                  type: VARCHAR(64)
                  constraints:
                    nullable: false
                  remarks: "OC名称"
              - column:
                  name: rank
                  type: TINYINT
                  constraints:
                    nullable: false
                  remarks: "OC级别"
              - column:
                  name: slot_code
                  type: VARCHAR(32)
                  constraints:
                    nullable: false
                  remarks: "岗位Code"
              - column:
                  name: slot_short_code
                  type: VARCHAR(16)
                  constraints:
                    nullable: false
                  remarks: "岗位短Code"
              - column:
                  name: pass_rate
                  type: INT
                  defaultValue: "60"
                  constraints:
                    nullable: false
                  remarks: "要求成功率"
              - column:
                  name: deleted
                  type: TINYINT
                  defaultValueComputed: '0'
                  constraints:
                    nullable: false
                  remarks: "删除标识 1为已删除"
              - column:
                  name: create_time
                  type: TIMESTAMP
                  defaultValueComputed: CURRENT_TIMESTAMP
                  constraints:
                    nullable: false
                  remarks: "创建时间"
              - column:
                  name: update_time
                  type: TIMESTAMP
                  defaultValueComputed: CURRENT_TIMESTAMP
                  constraints:
                    nullable: false
                  remarks: "更新时间"
        - sql:
            sql: |
              INSERT INTO torn_setting_oc (rank, oc_name) VALUES
              (3,'Gaslight the Way'),
              (3,'Smoke and Wing Mirrors'),
              (4,'Snow Blind'),
              (4,'Stage Fright'),
              (5,'Counter Offer'),
              (5,'Leave No Trace'),
              (5,'No Reserve'),
              (6,'Bidding War'),
              (6,'Honey Trap'),
              (7,'Blast from the Past'),
              (8,'Break the Bank'),
              (8,'Clinical Precision'),
              (8,'Stacking the Deck'),
              (9,'Ace in the Hole');
              
              INSERT INTO torn_setting_oc_slot (rank, oc_name, slot_code, slot_short_code) VALUES
              (3,'Gaslight the Way','Imitator#1','Imitator'),
              (3,'Gaslight the Way','Imitator#2','Imitator'),
              (3,'Gaslight the Way','Imitator#3','Imitator'),
              (3,'Gaslight the Way','Looter#1','Looter'),
              (3,'Gaslight the Way','Looter#2','Looter'),
              (3,'Gaslight the Way','Looter#3','Looter'),
              (3,'Smoke and Wing Mirrors','Car Thief#1','Car Thief'),
              (3,'Smoke and Wing Mirrors','Hustler#1','Hustler'),
              (3,'Smoke and Wing Mirrors','Hustler#2','Hustler'),
              (3,'Smoke and Wing Mirrors','Imitator#1','Imitator'),
              (4,'Snow Blind','Hustler#1','Hustler'),
              (4,'Snow Blind','Imitator#1','Imitator'),
              (4,'Snow Blind','Muscle#1','Muscle'),
              (4,'Snow Blind','Muscle#2','Muscle'),
              (4,'Stage Fright','Enforcer#1','Enforcer'),
              (4,'Stage Fright','Lookout#1','Lookout'),
              (4,'Stage Fright','Muscle#1','Muscle'),
              (4,'Stage Fright','Muscle#2','Muscle'),
              (4,'Stage Fright','Muscle#3','Muscle'),
              (4,'Stage Fright','Sniper#1','Sniper'),
              (5,'Counter Offer','Engineer#1','Engineer'),
              (5,'Counter Offer','Hacker#1','Hacker'),
              (5,'Counter Offer','Looter#1','Looter'),
              (5,'Counter Offer','Picklock#1','Picklock'),
              (5,'Counter Offer','Robber#1','Robber'),
              (5,'Leave No Trace','Imitator#1','Imitator'),
              (5,'Leave No Trace','Negotiator#1','Negotiator'),
              (5,'Leave No Trace','Techie#1','Techie'),
              (5,'No Reserve','Car Thief#1','Car Thief'),
              (5,'No Reserve','Engineer#1','Engineer'),
              (5,'No Reserve','Techie#1','Techie'),
              (6,'Bidding War','Bomber#1','Bomber'),
              (6,'Bidding War','Bomber#2','Bomber'),
              (6,'Bidding War','Driver#1','Driver'),
              (6,'Bidding War','Robber#1','Robber'),
              (6,'Bidding War','Robber#2','Robber'),
              (6,'Bidding War','Robber#3','Robber'),
              (6,'Honey Trap','Enforcer#1','Enforcer'),
              (6,'Honey Trap','Muscle#1','Muscle'),
              (6,'Honey Trap','Muscle#2','Muscle'),
              (7,'Blast from the Past','Bomber#1','Bomber'),
              (7,'Blast from the Past','Engineer#1','Engineer'),
              (7,'Blast from the Past','Hacker#1','Hacker'),
              (7,'Blast from the Past','Muscle#1','Muscle'),
              (7,'Blast from the Past','Picklock#1','Picklock'),
              (7,'Blast from the Past','Picklock#2','Picklock'),
              (8,'Break the Bank','Muscle#1','Muscle'),
              (8,'Break the Bank','Muscle#2','Muscle'),
              (8,'Break the Bank','Muscle#3','Muscle'),
              (8,'Break the Bank','Robber#1','Robber'),
              (8,'Break the Bank','Thief#1','Thief'),
              (8,'Break the Bank','Thief#2','Thief'),
              (8,'Clinical Precision','Assassin#1','Assassin'),
              (8,'Clinical Precision','Cat Burglar#1','Cat Burglar'),
              (8,'Clinical Precision','Cleaner#1','Cleaner'),
              (8,'Clinical Precision','Imitator#1','Imitator'),
              (8,'Stacking the Deck','Cat Burglar#1','Cat Burglar'),
              (8,'Stacking the Deck','Driver#1','Driver'),
              (8,'Stacking the Deck','Hacker#1','Hacker'),
              (8,'Stacking the Deck','Imitator#1','Imitator'),
              (9,'Ace in the Hole','Driver#1','Driver'),
              (9,'Ace in the Hole','Hacker#1','Hacker'),
              (9,'Ace in the Hole','Imitator#1','Imitator'),
              (9,'Ace in the Hole','Muscle#1','Muscle'),
              (9,'Ace in the Hole','Muscle#2','Muscle');

  - changeSet:
      id: add_temp_oc_disable_setting
      author: Bai
      changes:
        - insert:
            tableName: sys_setting
            columns:
              - column:
                  name: setting_key
                  value: "OC_TEMP_BLOCK_RANK"
              - column:
                  name: setting_value
                  value: "8"