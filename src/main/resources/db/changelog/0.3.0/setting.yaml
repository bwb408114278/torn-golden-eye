databaseChangeLog:
  - changeSet:
      id: add_faction_setting_alias
      author: Bai
      changes:
        - addColumn:
            tableName: torn_setting_faction
            columns:
              - column:
                  name: faction_alias
                  type: VARCHAR(128)
                  constraints:
                    nullable: false
                  defaultValue: ""
                  remarks: "帮派别名"
        - sql:
            sql: |
              UPDATE torn_setting_faction
              SET faction_alias = faction_short_name;
              
              UPDATE torn_setting_faction
              SET faction_alias = 'PHN,PN',
                  faction_short_name = 'PHN'
              WHERE id = 20465;
              
              UPDATE torn_setting_faction
              SET faction_alias = 'CCRC,CC'
              WHERE id = 27902;
              
              UPDATE torn_setting_faction
              SET faction_alias = 'SVH,SH'
              WHERE id = 36134;
              
              UPDATE torn_setting_faction
              SET faction_alias = 'NOV,Nov.',
                  faction_short_name = 'NOV'
              WHERE id = 16335;

  - changeSet:
      id: remove_key_use_date
      author: Bai
      changes:
        - sql:
            sql: |
              UPDATE torn_api_key SET deleted = 1 WHERE use_date < '2025-10-14'
        - dropColumn:
            tableName: torn_api_key
            columns:
              - column:
                  name: use_date

  - changeSet:
      id: split_user_and_base_data
      author: Bai
      changes:
        - insert:
            tableName: sys_setting
            columns:
              - column:
                  name: id
                  value: '19'
              - column:
                  name: setting_key
                  value: 'USER_DATA_LOAD_DATE'
              - column:
                  name: setting_value
                  value: '2025-10-14'

  - changeSet:
      id: split_faction_admin
      author: Bai
      changes:
        - delete:
            tableName: sys_setting
            where: id IN (15, 16)
        - addColumn:
            tableName: torn_setting_faction
            columns:
              - column:
                  name: group_id
                  type: BIGINT
                  defaultValueComputed: '0'
                  constraints:
                    nullable: false
                  remarks: "QQ群号"
              - column:
                  name: group_admin_ids
                  type: VARCHAR(128)
                  defaultValue: ""
                  constraints:
                    nullable: false
                  remarks: "群聊管理员ID"
              - column:
                  name: msg_block
                  type: BOOLEAN
                  defaultValueComputed: 'false'
                  constraints:
                    nullable: false
                  remarks: "是否屏蔽消息"
        - sql:
            sql: |
              UPDATE torn_setting_faction SET group_id = 818347578, group_admin_ids = '2722896589,2246839' WHERE id = 20465;
              UPDATE torn_setting_faction SET group_id = 966670136, group_admin_ids = '1219769164' WHERE id = 27902;
              UPDATE torn_setting_faction SET group_id = 798645562, group_admin_ids = '48341572' WHERE id = 11796;

  - changeSet:
      id: split_user_and_key
      author: Bai
      changes:
        - update:
            tableName: sys_setting
            columns:
              - column:
                  name: setting_key
                  value: KEY_LOAD_DATE
            where: id = 19
        - update:
            tableName: sys_setting
            columns:
              - column:
                  name: setting_key
                  value: USER_DATA_LOAD_DATE
              - column:
                  name: setting_value
                  value: '2025-10-26'
            where: id = 8